<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Filtration</title><meta name="title" content="API · Filtration"/><meta property="og:title" content="API · Filtration"/><meta property="twitter:title" content="API · Filtration"/><meta name="description" content="Documentation for Filtration."/><meta property="og:description" content="Documentation for Filtration."/><meta property="twitter:description" content="Documentation for Filtration."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Filtration</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="basic-usage.html">Basic Usage</a></li><li><a class="tocitem" href="examples.html">Examples</a></li><li class="is-active"><a class="tocitem" href="api-filtration.html">API</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="dev-filtration.html">Developpers</a></li><li><a class="tocitem" href="references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="api-filtration.html">API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="api-filtration.html">API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/remydutto/doc-Filtration.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Filtration.jl-API"><a class="docs-heading-anchor" href="#Filtration.jl-API">Filtration.jl API</a><a id="Filtration.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#Filtration.jl-API" title="Permalink"></a></h1><p>For the developers, here are the <a href="dev-filtration.html#dev-filtration">private methods</a>.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="api-filtration.html#Filtration.Filtration"><code>Filtration.Filtration</code></a></li><li><a href="api-filtration.html#Filtration.MaxVolume"><code>Filtration.MaxVolume</code></a></li><li><a href="api-filtration.html#Filtration.MaxVolume-NTuple{4, Function}"><code>Filtration.MaxVolume</code></a></li><li><a href="api-filtration.html#Filtration.MinEnergy-NTuple{6, Function}"><code>Filtration.MinEnergy</code></a></li><li><a href="api-filtration.html#Filtration.MinEnergy"><code>Filtration.MinEnergy</code></a></li><li><a href="api-filtration.html#Filtration.cuts-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.cuts</code></a></li><li><a href="api-filtration.html#Filtration.cuts-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.cuts</code></a></li><li><a href="api-filtration.html#Filtration.dispersial_locus-Tuple{Real, MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.dispersial_locus</code></a></li><li><a href="api-filtration.html#Filtration.dispersial_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.dispersial_locus</code></a></li><li><a href="api-filtration.html#Filtration.end_switching_locus-Tuple{MinEnergy, Tuple{Real, Real}}"><code>Filtration.end_switching_locus</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_MP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_MP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MSP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_MSP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MSP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_MSP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_P-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_P</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_P-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_P</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_PSP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_PSP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_PSP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_PSP</code></a></li><li><a href="api-filtration.html#Filtration.plot_max_volume"><code>Filtration.plot_max_volume</code></a></li><li><a href="api-filtration.html#Filtration.plot_min_energy-NTuple{6, Function}"><code>Filtration.plot_min_energy</code></a></li><li><a href="api-filtration.html#Filtration.plot_synthesis-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.plot_synthesis</code></a></li><li><a href="api-filtration.html#Filtration.plot_synthesis-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.plot_synthesis</code></a></li><li><a href="api-filtration.html#Filtration.switching_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}}"><code>Filtration.switching_locus</code></a></li><li><a href="api-filtration.html#Filtration.switching_locus-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.switching_locus</code></a></li></ul><h2 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.Filtration" href="#Filtration.Filtration"><code>Filtration.Filtration</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><a href="api-filtration.html#Filtration.Filtration"><code>Filtration</code></a> module.</p><p>Lists all the imported modules and packages:</p><ul><li><code>Base</code></li><li><code>Core</code></li><li><code>DataInterpolations</code></li><li><code>DocStringExtensions</code></li><li><code>FiniteDifferences</code></li><li><code>ForwardDiff</code></li><li><code>LaTeXStrings</code></li><li><code>MINPACK</code></li><li><code>Nemo</code></li><li><code>OptimalControl</code></li><li><code>OrdinaryDiffEq</code></li><li><code>Plots</code></li><li><code>Roots</code></li><li><code>Symbolics</code></li></ul><p>List of all the exported names:</p><ul><li><a href="api-filtration.html#Filtration.MaxVolume"><code>MaxVolume</code></a></li><li><a href="api-filtration.html#Filtration.MinEnergy"><code>MinEnergy</code></a></li><li><a href="api-filtration.html#Filtration.cuts-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>cuts</code></a></li><li><a href="api-filtration.html#Filtration.dispersial_locus-Tuple{Real, MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>dispersial_locus</code></a></li><li><a href="api-filtration.html#Filtration.end_switching_locus-Tuple{MinEnergy, Tuple{Real, Real}}"><code>end_switching_locus</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve-Tuple{MaxVolume, Real, Real, Real}"><code>indirect_solve</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MP-Tuple{MaxVolume, Real, Real, Real}"><code>indirect_solve_MP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_MSP-Tuple{MaxVolume, Real, Real, Real}"><code>indirect_solve_MSP</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_P-Tuple{MaxVolume, Real, Real, Real}"><code>indirect_solve_P</code></a></li><li><a href="api-filtration.html#Filtration.indirect_solve_PSP-Tuple{MaxVolume, Real, Real, Real}"><code>indirect_solve_PSP</code></a></li><li><a href="api-filtration.html#Filtration.plot_max_volume"><code>plot_max_volume</code></a></li><li><a href="api-filtration.html#Filtration.plot_min_energy-NTuple{6, Function}"><code>plot_min_energy</code></a></li><li><a href="api-filtration.html#Filtration.plot_synthesis-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>plot_synthesis</code></a></li><li><a href="api-filtration.html#Filtration.switching_locus-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>switching_locus</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.MaxVolume" href="#Filtration.MaxVolume"><code>Filtration.MaxVolume</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of a MaxVolume model, composed by:</p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>dynamics : the cost and state dynamics function</li><li>dynamics! : the cost and state dynamics function</li><li>df₊ : the function <span>$f_+&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>df₋ : the function <span>$f_-&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>dg₊ : the function <span>$g_+&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>dg₋ : the function <span>$g_-&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>mₛ : the singular state <span>$m_s$</span></li><li>uₛ : the singular control <span>$u_s$</span></li><li>λₛ : the singular costate <span>$\lambda_s$</span></li><li>Δt : the value <span>$\Delta t = t_f - T$</span>, where <span>$T$</span> is the final time to leave the singular arc</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.MaxVolume-NTuple{4, Function}" href="#Filtration.MaxVolume-NTuple{4, Function}"><code>Filtration.MaxVolume</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MaxVolume(
    f₊::Function,
    f₋::Function,
    g₊::Function,
    g₋::Function;
    mₛ_guess
) -&gt; MaxVolume
</code></pre><p>Constructor for MaxVolume structure. </p><p><strong>Arguments</strong></p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>mₛ<em>guess : initial guess for the singular state ``m</em>s``, initialized to  0.5</li></ul><p><strong>Returns</strong></p><ul><li>model : the <code>MaxVolume</code> model</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.MinEnergy" href="#Filtration.MinEnergy"><code>Filtration.MinEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of a MinEnergy model, composed by:</p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>e₊ : the function <span>$e_+(m)$</span></li><li>e₋ : the function <span>$e_-(m)$</span></li><li>dynamics : the cost and state dynamics function</li><li>dynamics! : the cost and state dynamics function</li><li>df₊ : the function <span>$f_+&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>df₋ : the function <span>$f_-&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>dg₊ : the function <span>$g_+&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>dg₋ : the function <span>$g_-&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>de₊ : the function <span>$e_+&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>de₋ : the function <span>$e_-&#39;(m)$</span>, compute thanks to <code>ForwardDiff</code> package</li><li>mₛ : the singular state <span>$m_s$</span></li><li>uₛ : the singular control <span>$u_s$</span></li><li>λₘₛ : the singular costate <span>$\lambda_{ms}$</span> associated to the state <span>$m$</span></li><li>λᵥ : the constant costate <span>$\lambda_v$</span> associated to the state <span>$v$</span></li><li>Δv : the value <span>$\Delta_v = v_f - v(T)$</span>, where <span>$T$</span> is the final time to leave the singular arc</li><li>Δt : the value <span>$\Delta t = t_f - T$</span>, where <span>$T$</span> is the final time to leave the singular arc</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.MinEnergy-NTuple{6, Function}" href="#Filtration.MinEnergy-NTuple{6, Function}"><code>Filtration.MinEnergy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MinEnergy(
    f₊::Function,
    f₋::Function,
    g₊::Function,
    g₋::Function,
    e₊::Function,
    e₋::Function;
    mₛ_guess
) -&gt; MinEnergy
</code></pre><p>Constructor for MinEnergy structure. </p><p><strong>Arguments</strong></p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>e₊ : the function <span>$e_+(m)$</span></li><li>e₋ : the function <span>$e_-(m)$</span></li></ul><p><strong>Returns</strong></p><ul><li>model : the <code>MinEnergy</code> model</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.cuts-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.cuts-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.cuts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cuts(
    model::MaxVolume,
    tlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real}
) -&gt; Tuple{Any, Any}
</code></pre><p>Compute the cuts <span>$m_-(t)$</span> and <span>$m_+(t)$</span>, which corresponds to the curves which leads to <span>$m_s$</span> at time <span>$T$</span>. The function <span>$m₋$</span> is the solution on <span>$[0, T]$</span> of</p><p class="math-container">\[\left\{\begin{array}{ll}
    \dot v = g_-(m) - g_+(m), &amp; \quad v(T) = 0, \\\dot m = f_-(m) - f_+(m), &amp; \quad m(T) = m_s,
\end{array} \right.\]</p><p>and the function <span>$m₊$</span> is the solution on <span>$[0, T]$</span> of </p><p class="math-container">\[\left\{\begin{array}{ll}
    \dot v = g_-(m) + g_+(m), &amp; \quad v(T) = 0 , \\\dot m = f_-(m) + f_+(m), &amp; \quad m(T) = m_s,
\end{array} \right.\]</p><p>where <span>$T = t_f - \Delta t$</span> corresponds to the optimal time to exit the singular arc  and <span>$m_s$</span> the singular state.    </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The cost <span>$v(T)$</span> at the initial time <span>$T$</span> is initialized to 0. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>tlim : tuple of real which corresponds to the limits of time <span>$t$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span></li></ul><p><strong>Returns</strong></p><ul><li>cut₋ : the function <span>$m_-$</span>, as an <code>ODESolution</code></li><li>cut₊ : the function <span>$m_+$</span>, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.cuts-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.cuts-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.cuts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cuts(
    model::MinEnergy,
    vlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real}
) -&gt; Tuple{Any, Any}
</code></pre><p>Compute the cuts <span>$m_-(t)$</span> and <span>$m_+(t)$</span>, which corresponds to the curves which leads to <span>$m_s$</span> at time <span>$T$</span>. The function <span>$m₋$</span> is the solution on <span>$[T, tf]$</span> of</p><p class="math-container">\[\left\{ \begin{array}{ll}
    \dot e = e_-(m) - e_+(m), &amp; \quad e(T) = 0, \\\dot m = f_-(m) - f_+(m), &amp; \quad m(T) = m_s, \\\dot v = g_-(m) - g_+(m), &amp; \quad v(T) = v_T,
\end{array} \right.\]</p><p>and the function <span>$m₊$</span> is the solution on <span>$[T, tf]$</span> of </p><p class="math-container">\[\left\{\begin{array}{ll}
    \dot e = e_-(m) + e_+(m), &amp; \quad e(T) = 0, \\\dot m = f_-(m) + f_+(m), &amp; \quad m(T) = m_s, \\\dot v = g_-(m) + g_+(m), &amp; \quad v(T) = v_T,
\end{array} \right.\]</p><p>where <span>$T = t_f - \Delta t$</span> corresponds to the optimal time to exit the singular arc, <span>$v_T = v_f - \Delta_v$</span> the associated state <span>$v$</span> and <span>$m_s$</span> the singular state.   </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The cost <span>$e(T)$</span> at time <span>$T$</span> is initialized to 0. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>vlim : tuple of real which corresponds to the limits of volume <span>$v$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span> </li></ul><p><strong>Returns</strong></p><ul><li>cut₋ : the function <span>$m_-$</span>, as an <code>ODESolution</code></li><li>cut₊ : the function <span>$m_+$</span>, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.dispersial_locus-Tuple{Real, MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.dispersial_locus-Tuple{Real, MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.dispersial_locus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dispersial_locus(
    t::Real,
    model::MaxVolume,
    tlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real};
    m_guess
) -&gt; Float64
</code></pre><p>Compute some points of the dispersial locus curve, which corresponds to the curve where the cost associated to u₋ ∘ u₊ is equal to the cost associated to u₊. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only when a dispersial locus happened, ie. when the switching locus don&#39;t hit the bounds. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>tlim : tuple of real which corresponds to the limits of time <span>$t$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span></li><li>SL : an <code>ODESolution</code> which corresponds to the switching locus computed by <code>switching_locus</code> function</li></ul><p><strong>Returns</strong></p><ul><li>tspan_DL : array of time t</li><li>mspan_DL : array of state m </li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.dispersial_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.dispersial_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.dispersial_locus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dispersial_locus(
    m::Real,
    model::MinEnergy,
    vlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real}
) -&gt; Any
</code></pre><p>Dispersial locus function, which gives the volume <span>$v$</span> from a mass <span>$m$</span>, which corresponds to the curve where the cost associated to u₋ ∘ u₊ is equal to the cost associated to u₊. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only when a dispersial locus happened, ie. when the end of the switching curve (given by the <code>end_switching_locus</code> function) is below the maximal bound of <span>$m$</span>. </p></div></div><p><strong>Arguments</strong></p><ul><li><p>m : the mass <span>$m$</span></p></li><li><p>model : a <code>MinEnergy</code></p></li><li><p>vlim : tuple of real which corresponds to the limits of volume <span>$v$</span></p></li><li><p>Return</p></li></ul><p>v : the volume <span>$v$</span></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.end_switching_locus-Tuple{MinEnergy, Tuple{Real, Real}}" href="#Filtration.end_switching_locus-Tuple{MinEnergy, Tuple{Real, Real}}"><code>Filtration.end_switching_locus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">end_switching_locus(
    model::MinEnergy,
    vlim::Tuple{Real, Real};
    m_guess
) -&gt; Any
</code></pre><p>Compute the mass <span>$m$</span> which corresponds to the end of the switching locus. </p><p>Denoting <span>$SL$</span> the switching locus function, this end point <span>$m$</span> is given by finding a root of </p><p class="math-container">\[    SL&#39;(m) * (f₋(m) - f₊(m)) - (g₋(m) - g₊(m))\]</p><p>Since a rootfinding function is used in the computation of the switching locus function, the derivative of <span>$SL$</span> is computed by finite differences method, thanks to the <code>FiniteDifferences</code> package. </p><p><strong>Arguments</strong></p><ul><li>model: a <code>MinEnergy</code></li><li>vlim : tuple of real which corresponds to the limits of volume <span>$v$</span></li><li>m<em>guess : initial guess for <span>$m$</span>, initialized to the singular state ``m</em>s`` if not provided</li></ul><p><strong>Return</strong></p><ul><li>m : the limit mass <span>$m$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve-Tuple{MaxVolume, Real, Real, Real}" href="#Filtration.indirect_solve-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve(
    model::MaxVolume,
    t0::Real,
    tf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MaxVolume</code> model by indirect shooting.</p><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>t0 : the initial time <span>$t_0$</span></li><li>tf : the final time <span>$t_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve-Tuple{MinEnergy, Real, Real, Real}" href="#Filtration.indirect_solve-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve(
    model::MinEnergy,
    v0::Real,
    vf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MinEnergy</code> model by indirect shooting.</p><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>v0 : the initial volume <span>$v_0$</span></li><li>vf : the final volume <span>$v_f$</span></li><li>m0 : the initial state <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_MP-Tuple{MaxVolume, Real, Real, Real}" href="#Filtration.indirect_solve_MP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_MP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_MP(
    model::MaxVolume,
    t0::Real,
    tf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MaxVolume</code> model by indirect method, with the structure given by <span>$u_- \circ u_+$</span>, and when the change is done by intersection with the switching curve</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>t0 : the initial time <span>$t_0$</span></li><li>tf : the final time <span>$t_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_MP-Tuple{MinEnergy, Real, Real, Real}" href="#Filtration.indirect_solve_MP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_MP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_MP(
    model::MinEnergy,
    v0::Real,
    vf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MinEnergy</code> model by indirect method, with the structure given by <span>$u_- \circ u_+$</span>, and when the change is done by intersection with the switching curve</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>v0 : the initial volume <span>$v_0$</span></li><li>vf : the final volume <span>$v_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_MSP-Tuple{MaxVolume, Real, Real, Real}" href="#Filtration.indirect_solve_MSP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_MSP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_MSP(
    model::MaxVolume,
    t0::Real,
    tf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MaxVolume</code> model, with the structure given by <span>$u_- \circ u_s \circ u_+$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>t0 : the initial time <span>$t_0$</span></li><li>tf : the final time <span>$t_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_MSP-Tuple{MinEnergy, Real, Real, Real}" href="#Filtration.indirect_solve_MSP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_MSP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_MSP(
    model::MinEnergy,
    v0::Real,
    vf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MinEnergy</code> model, with the structure given by <span>$u_- \circ u_s \circ u_+$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>v0 : the initial volume <span>$v_0$</span></li><li>vf : the final volume <span>$v_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_P-Tuple{MaxVolume, Real, Real, Real}" href="#Filtration.indirect_solve_P-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_P</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_P(
    model::MaxVolume,
    t0::Real,
    tf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MaxVolume</code> model, with the structure given by <span>$u_+$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>t0 : the initial time <span>$t_0$</span></li><li>tf : the final time <span>$t_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_P-Tuple{MinEnergy, Real, Real, Real}" href="#Filtration.indirect_solve_P-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_P</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_P(
    model::MinEnergy,
    v0::Real,
    vf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MinEnergy</code> model, with the structure given by <span>$u_+$</span>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>v0 : the initial volume <span>$v_0$</span></li><li>vf : the final volume <span>$v_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_PSP-Tuple{MaxVolume, Real, Real, Real}" href="#Filtration.indirect_solve_PSP-Tuple{MaxVolume, Real, Real, Real}"><code>Filtration.indirect_solve_PSP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_PSP(
    model::MaxVolume,
    t0::Real,
    tf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to a <code>MaxVolume</code> model by indirect shooting, with the structure given by <span>$u_+ \circ u_s \circ u_+$</span></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead. </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>t0 : the initial time <span>$t_0$</span></li><li>tf : the final time <span>$t_f$</span></li><li>m0 : the initial mass <span>$m_0$</span></li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.indirect_solve_PSP-Tuple{MinEnergy, Real, Real, Real}" href="#Filtration.indirect_solve_PSP-Tuple{MinEnergy, Real, Real, Real}"><code>Filtration.indirect_solve_PSP</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indirect_solve_PSP(
    model::MinEnergy,
    v0::Real,
    vf::Real,
    m0::Real
) -&gt; Any
</code></pre><p>Solve the optimal control problem associated to the membrane filtration model by indirect shooting,  with the structure given by <span>$u_+ \circ u_s \circ u_+$</span></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function must be used only if we know the structure. If you don&#39;t know the structure of the solution, use <code>indirect_solve</code> function instead.  </p></div></div><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>v0 : the initial volume <span>$v_0$</span></li><li>vf : the final volume <span>$v_f$</span></li><li>m0 : the initial mass <span>$m_0$</span> </li></ul><p><strong>Returns</strong></p><ul><li>sol: the solution, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.plot_max_volume" href="#Filtration.plot_max_volume"><code>Filtration.plot_max_volume</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_max_volume(
    f₊::Function,
    f₋::Function,
    g₊::Function,
    g₋::Function
) -&gt; Plots.Plot
plot_max_volume(
    f₊::Function,
    f₋::Function,
    g₊::Function,
    g₋::Function,
    xlim::Tuple{Real, Real}
) -&gt; Plots.Plot
</code></pre><p>Plot a function where we need to ensure that there is only one zero of it, on the domain of interest. An initial guess of this zero can be provided to the construtor of the <code>MaxVolume</code> type. </p><p><strong>Arguments</strong></p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>xlim : limits for x axis, initialized to (0,10)</li></ul><p><strong>Return</strong></p><ul><li>plt : the plot</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.plot_min_energy-NTuple{6, Function}" href="#Filtration.plot_min_energy-NTuple{6, Function}"><code>Filtration.plot_min_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_min_energy(
    f₊::Function,
    f₋::Function,
    g₊::Function,
    g₋::Function,
    e₊::Function,
    e₋::Function;
    xlim
) -&gt; Plots.Plot
</code></pre><p>Plot a function where we need to ensure that there is only one zero of it, on the domain of interest. An initial guess of this zero can be provided to the construtor of the <code>MinEnergy</code> type. </p><p><strong>Arguments</strong></p><ul><li>f₊ : the function <span>$f_+(m)$</span></li><li>f₋ : the function <span>$f_-(m)$</span></li><li>g₊ : the function <span>$g_+(m)$</span></li><li>g₋ : the function <span>$g_-(m)$</span></li><li>e₊ : the function <span>$e_+(m)$</span></li><li>e₋ : the function <span>$e_-(m)$</span></li><li>xlim : limits for x axis, initialized to (0,10)</li></ul><p><strong>Return</strong></p><ul><li>plt : the plot</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.plot_synthesis-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.plot_synthesis-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.plot_synthesis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_synthesis(
    model::MaxVolume,
    tlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real};
    DL_nb_points
) -&gt; Plots.Plot
</code></pre><p>Plot the optimal synthesis of a <code>MaxVolume</code>.</p><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>tlim : tuple of real which corresponds to the limits of time <span>$t$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span></li><li>DL<em>nb</em>points : number of points computed for the dispersial locus curve, initialized to 10</li></ul><p><strong>Returns</strong></p><ul><li>plt : the plot</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.plot_synthesis-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.plot_synthesis-Tuple{MinEnergy, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.plot_synthesis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_synthesis(
    model::MinEnergy,
    vlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real};
    SL_nb_points,
    DL_nb_points
) -&gt; Plots.Plot
</code></pre><p>Plot the optimal synthesis of a <code>MinEnergy</code>.</p><p><strong>Arguments</strong></p><ul><li>model : a <code>MinEnergy</code></li><li>vlim : tuple of real which corresponds to the limits of time <span>$v$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span></li><li>SL<em>nb</em>points : number of points computed for the switching locus curve, initialized to 10</li><li>DL<em>nb</em>points : number of points computed for the dispersial locus curve, initialized to 10</li></ul><p><strong>Returns</strong></p><ul><li>plt : the plot</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.switching_locus-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}" href="#Filtration.switching_locus-Tuple{MaxVolume, Tuple{Real, Real}, Tuple{Real, Real}}"><code>Filtration.switching_locus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">switching_locus(
    model::MaxVolume,
    tlim::Tuple{Real, Real},
    mlim::Tuple{Real, Real}
) -&gt; Any
</code></pre><p>Compute the switching locus <span>$S(m)$</span> which give the time with respect to the deposit mass <span>$m$</span>. This function is the solution of </p><p class="math-container">\[S&#39;(m) = \frac{1}{f_+(m) + f_-(m)} - \frac{ \gamma&#39;(m)}{\tilde g&#39;(m_T(m)) (f_+(m_T(m)) + f_-(m_T(m)))}, \quad S(mₛ) = T \]</p><p>where </p><p class="math-container">\[\begin{aligned}
    m_T(m)          &amp;= \tilde g^{-1}(\gamma(m)), \\\tilde g(m)    &amp;= g_-(m) + g_+(m), \\\gamma(m)      &amp;= - \frac{f_-(m) g_+(m)}{f_+(m)} + g_-(m),
\end{aligned}\]</p><p>and <span>$T = t_f - \Delta t$</span>. The value of <span>$\tilde g^{-1}(y)$</span> is numerically comute by solving <span>$\tilde g(x) - y = 0$</span>. </p><p>In order to only compute the switching locus and not the dispersial one, the integration of the previous ODE stop when </p><p class="math-container">\[S&#39;(m) (f_-(m) - f_+(m)) - 1 = 0. \]</p><p>This condition can be handle thanks to the <code>ContinuousCallback</code> function of the <code>OrdinaryDiffEq</code> package. </p><p><strong>Arguments</strong></p><ul><li>model : a <code>MaxVolume</code></li><li>tlim : tuple of real which corresponds to the limits of time <span>$t$</span></li><li>mlim : tuple of real which corresponds to the limits of mass <span>$m$</span></li></ul><p><strong>Returns</strong></p><ul><li>switching_locus : the function <span>$S(m)$</span>, as an <code>ODESolution</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Filtration.switching_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}}" href="#Filtration.switching_locus-Tuple{Real, MinEnergy, Tuple{Real, Real}}"><code>Filtration.switching_locus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">switching_locus(
    m::Real,
    model::MinEnergy,
    vlim::Tuple{Real, Real};
    m_guess
) -&gt; Any
</code></pre><p>Switching locus function, which gives the volume <span>$v$</span> from the mass <span>$m$</span>. </p><p>From a given state <span>$m$</span> which belongs to this switching curve, the associated final state <span>$m_f$</span> is computed by finding a zero of </p><p class="math-container">\[    H(m, m_f) = \lambda_m(m, m_f) (f_+(m) + f_-(m)) + \lambda_v(m_f)(g_+(m) + g_-(m)) - (e_+(m) + e_-(m))\]</p><p>where </p><p class="math-container">\[    \lambda_m(m, m_f) = \frac{e_+(m) - \lambda_v(m_f) g_+(m)}{f_+(m)}\]</p><p>and </p><p class="math-container">\[    \lambda_v(m_f) =  \frac{e_+(m) + e_-(m)}{g_+(m) + g_-(m)}. \]</p><p>From this final state <span>$m_f$</span>, with the final volume <span>$v_f$</span>, the volume <span>$v$</span> is computed by a backward integration of the dynamic which stop when <span>$m(t) = m$</span>, thanks to a <code>ContinuousCallback</code>. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The given state <span>$m$</span> must belong to the switching locus curve, ie. <span>$m_s \leq m \leq m_d$</span> where <span>$m_s$</span> is the singular state, given by <code>model.mₛ</code>, and where <span>$m_d$</span> is the end of the dispersial locus, computed by the <code>end_switching_locus</code> function.   </p></div></div><p><strong>Arguments</strong></p><ul><li>m : the mass <span>$m$</span></li><li>model : a <code>MinEnergy</code></li><li>vlim : tuple of real which corresponds to the limits of volume <span>$v$</span></li><li>m<em>guess : initial guess for <span>$m$</span>, initialized to the singular state ``m</em>s`` if not provided</li></ul><p><strong>Retrun</strong></p><ul><li>v : the volume <span>$v$</span></li></ul></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="examples.html">« Examples</a><a class="docs-footer-nextpage" href="dev-filtration.html">Developpers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 11 March 2025 18:05">Tuesday 11 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
