<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Usage · Filtration</title><meta name="title" content="Basic Usage · Filtration"/><meta property="og:title" content="Basic Usage · Filtration"/><meta property="twitter:title" content="Basic Usage · Filtration"/><meta name="description" content="Documentation for Filtration."/><meta property="og:description" content="Documentation for Filtration."/><meta property="twitter:description" content="Documentation for Filtration."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Filtration</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li class="is-active"><a class="tocitem" href="basic-usage.html">Basic Usage</a><ul class="internal"><li><a class="tocitem" href="#Max-volume-case"><span>Max volume case</span></a></li><li><a class="tocitem" href="#Min-Energy-case"><span>Min Energy case</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="api-filtration.html">API</a></li><li><a class="tocitem" href="dev-filtration.html">Developpers</a></li><li><a class="tocitem" href="references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="basic-usage.html">Basic Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="basic-usage.html">Basic Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/remydutto/doc-Filtration.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-usage"><a class="docs-heading-anchor" href="#Basic-usage">Basic usage</a><a id="Basic-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-usage" title="Permalink"></a></h1><p>The goal of the <code>Filtration.jl</code> package is to provide optimal systesis and optimal solution for a large classe of optimal control problems used for membrane filtration process. There exists mainly two formulation of such optimal control problem which can be found in the litterature.  </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The provided function given by <code>Filtration.jl</code> package can work whatever the inputs functions are. However, we need to be sure that there exists solutions for this kind of problems and that there exist exacly one root on the domain of interest of a function given by the <code>check_root</code> function. </p></div></div><p>Here is the used packages to run this page. </p><pre><code class="language-julia hljs">using Filtration
using Plots</code></pre><h2 id="Max-volume-case"><a class="docs-heading-anchor" href="#Max-volume-case">Max volume case</a><a id="Max-volume-case-1"></a><a class="docs-heading-anchor-permalink" href="#Max-volume-case" title="Permalink"></a></h2><h3 id="General-description"><a class="docs-heading-anchor" href="#General-description">General description</a><a id="General-description-1"></a><a class="docs-heading-anchor-permalink" href="#General-description" title="Permalink"></a></h3><p>Let us consider the membrane filtration process where the goal is to maximize the water net production </p><p class="math-container">\[    \max_{x(\cdot), u(\cdot)} \int_{t_0}^{t_f} \frac{1+u(t)}{2} g_1(m(t))  + \frac{1-u(t)}{2} g_2(m(t)), \]</p><p>where the control <span>$u(\cdot)$</span> corresponds to the filtration mode (1 during filtration and -1 during backwash) and the state <span>$m(\cdot)$</span> is the mass of the cake layer formed during the water filtration. The dynamic of this state is given by </p><p class="math-container">\[    \dot m(t) = \frac{1+u(t)}{2} f_1(m(t)) + \frac{1-u(t)}{2} f_2(m(t)), \quad t \in [t_0, t_f]\]</p><p>with the initial condition <span>$m(0) = m_0$</span> and where the initial time <span>$t_0$</span> and the final time <span>$t_f$</span> are fixed. </p><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>In this example, these functions are defined by using the [<a href="https://www.researchgate.net/publication/272506325_A_simple_model_of_anaerobic_membrane_bioreactor_for_control_design_coupling_the_AM2b_model_with_a_simple_membrane_fouling_dynamics">Benyahia et al., 2013</a>] model, where the functions are defined on the following code section. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The function &#39;check_root&#39; and &#39;Model&#39; need the functions of the model in inputs. The order of these functions is importants. We need to provide first the two function associated to the cost, and after the function(s) associated to the state(s). The (first) state corresponds to the state that is used on the dynamic of all functions. For the order of the couple of functions, we need to provide first the function that multiply the control <span>$u$</span>. </p></div></div><p>We can use the <code>check_root</code> function to ensure that there exsit a unique zero of the plotted function.</p><pre><code class="language-julia hljs">a = 1; b = 1; e = 1;
p = [a, b, e]

f₁(m,p) = p[2] / (p[3] + m)
f₂(m,p) = -p[1] * m
g(m,p)  = 1 / (p[3] + m)
g₁(m,p) = g(m,p)
g₂(m,p) = -g(m,p)

check_root(g₁, g₂, f₁, f₂, p, :max)</code></pre><img src="basic-usage-5adf8f2f.svg" alt="Example block output"/><p>We can provide an initial guess of this zero to the <code>MaxVolume</code>. </p><pre><code class="language-julia hljs">model = Model(g₁, g₂, f₁, f₂, p, :max, initial_guess = 2.)</code></pre><h3 id="Optimal-synthesis"><a class="docs-heading-anchor" href="#Optimal-synthesis">Optimal synthesis</a><a id="Optimal-synthesis-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-synthesis" title="Permalink"></a></h3><p>The optimal systhesis of this problem can be constructed by the <code>Synthesis</code> function, and plot with the classical <code>plot</code> function</p><pre><code class="language-julia hljs">tlim = (0,10); mlim = (0,10)
synthesis = Synthesis(model, tlim, mlim)
plt = plot(synthesis, xlabel = &quot;Time (t)&quot;, ylabel = &quot;Mass (m)&quot;, legend = :bottomright)</code></pre><img src="basic-usage-12321f0e.svg" alt="Example block output"/><h3 id="Solution-trajectories"><a class="docs-heading-anchor" href="#Solution-trajectories">Solution trajectories</a><a id="Solution-trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-trajectories" title="Permalink"></a></h3><p>The function <code>solution</code> extract from the synthesis the optimal trajectory. We can easily add some optimal state trajectories on the previous created plot, thanks to the <code>add_solution_to_synthesis!</code> function.</p><pre><code class="language-julia hljs">sol = solution(synthesis, tlim[1], tlim[2], 1)
add_solution_to_synthesis!(plt, sol, axis_arrow = :x, element = [1])
sol = solution(synthesis, tlim[1], tlim[2], 5)
add_solution_to_synthesis!(plt, sol, axis_arrow = :y, element = [1])
for t0 ∈ range(tlim[1], tlim[2])
    sol = solution(synthesis, t0, tlim[2], mlim[1])
    add_solution_to_synthesis!(plt, sol, axis_arrow = :x, element = [1])
end
for t0 ∈ range(tlim[1], synthesis.SL.u[end], 10)
    if t0 != synthesis.SL.u[end]
        sol = solution(synthesis, t0, tlim[2], mlim[2])
        add_solution_to_synthesis!(plt, sol, axis_arrow = :y, element = [1])
    end
end
for m0 ∈ range(synthesis.SL.t[1], synthesis.SL.t[end], 10)
    if m0 != synthesis.SL.t[end] &amp;&amp; m0 != synthesis.SL.t[1]
        t0 = synthesis.SL(m0)
        sol = solution(synthesis, t0, tlim[2], m0)
        add_solution_to_synthesis!(plt, sol, axis_arrow = :x)
    end
end
plt</code></pre><img src="basic-usage-6f60972d.svg" alt="Example block output"/><h2 id="Min-Energy-case"><a class="docs-heading-anchor" href="#Min-Energy-case">Min Energy case</a><a id="Min-Energy-case-1"></a><a class="docs-heading-anchor-permalink" href="#Min-Energy-case" title="Permalink"></a></h2><h3 id="General-description-2"><a class="docs-heading-anchor" href="#General-description-2">General description</a><a class="docs-heading-anchor-permalink" href="#General-description-2" title="Permalink"></a></h3><p>We can also consider another case where the goal is to minimize the energy </p><p class="math-container">\[    \min_{x(\cdot), u(\cdot), t_f} \int_{t_0}^{t_f} \frac{1+u(t)}{2} e_1(m(t)) + \frac{1-u(t)}{2} e_2(m(t)), \]</p><p>where the control <span>$u(\cdot)$</span> corresponds to the filtration mode (1 during filtration and -1 during backwash) and the state <span>$m(\cdot)$</span> is the mass of the cake layer formed during the water filtration. The dynamic of this state is given by </p><p class="math-container">\[    \dot m(t) = \frac{1+u(t)}{2} f_1(m(t)) + \frac{1-u(t)}{2} f_2(m(t)), \quad t \in [t_0, t_f].\]</p><p>We also want to obtain a final volume <span>$v(t_f) = v_f$</span> of water at the final time <span>$t_f$</span>. The dynamic of the state is given by </p><p class="math-container">\[    \dot v(t) = \frac{1+u(t)}{2} g_1(m(t)) + \frac{1-u(t)}{2} g_2(m(t)), \quad t \in [t_0, t_f]. \]</p><p>The initial time <span>$t_0$</span> is fixed but the final time <span>$t_f$</span> is free. </p><h3 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example</a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h3><p>In this example, these functions are defined by using the [<a href="https://ieeexplore.ieee.org/document/9143741">Aichouche et al., 2020</a>] model, where the functions are defined on the following code section.</p><p>We can use the <code>check_root</code> function to ensure that there exits a unique zero of the plotted function.</p><pre><code class="language-julia hljs">ap = 0; bp = 1; cp = 0.16; dp = 3; Qp = 1
ar = 0.5; cr = 0.64; dr = 12; Qr = 2
p = [ap, bp, cp, dp, Qp, ar, cr, dr, Qr]

f₁(m,p) = -p[1]*m + p[2]
f₂(m,p) = -p[6]*m
g₁(m,p) = p[5]
g₂(m,p) = -p[9]
e₁(m,p) = p[3]*m + p[4]
e₂(m,p) = p[7]*m + p[8]

check_root(e₁, e₂, f₁, f₂, g₁, g₂, p, :min; xlim = (0, 30))</code></pre><img src="basic-usage-fb0f0d78.svg" alt="Example block output"/><p>We can provide an initial guess of this zero to the <code>Model</code>. </p><pre><code class="language-julia hljs">model = Model(e₁, e₂, f₁, f₂, g₁, g₂, p, :min; initial_guess = 20.)</code></pre><h3 id="Optimal-synthesis-2"><a class="docs-heading-anchor" href="#Optimal-synthesis-2">Optimal synthesis</a><a class="docs-heading-anchor-permalink" href="#Optimal-synthesis-2" title="Permalink"></a></h3><p>The optimal systhesis of this problem can be constructed by the <code>Synthesis</code> function, and plotted thanks to the <code>Plot</code> one. </p><pre><code class="language-julia hljs">vlim = (0,50); mlim = (0,50)
synthesis = Synthesis(model, vlim, mlim)
plt = plot(synthesis, xlabel = &quot;Volume (v)&quot;, ylabel = &quot;Mass (m)&quot;, legend = :bottomright)</code></pre><img src="basic-usage-54ac9e9b.svg" alt="Example block output"/><h3 id="Solutions-trajectories"><a class="docs-heading-anchor" href="#Solutions-trajectories">Solutions trajectories</a><a id="Solutions-trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Solutions-trajectories" title="Permalink"></a></h3><p>The function <code>solution</code> extract from the synthesis the optimal trajectory. We can easily add some optimal state trajectories on the previous created plot, thanks to the <code>add_solution_to_synthesis!</code> function.</p><pre><code class="language-julia hljs">sol = solution(synthesis, vlim[1], vlim[2], mlim[2])
add_solution_to_synthesis!(plt, sol, axis_arrow = :x, element = [2,3])
for m0 ∈ range(mlim[1],model.xₛ, 5)
    sol = solution(synthesis, vlim[1], vlim[2], m0)
    add_solution_to_synthesis!(plt, sol, axis_arrow = :x, element = [1])
end
for v0 ∈ range(vlim[1],vlim[2], 10)
    sol = solution(synthesis, v0, vlim[2], mlim[1])
    add_solution_to_synthesis!(plt, sol, axis_arrow = :x, element = [1])
end
for v0 ∈ range(vlim[1],synthesis.SL.u[end], 10)
    sol = solution(synthesis, v0, vlim[2], mlim[2])
    add_solution_to_synthesis!(plt, sol, axis_arrow = :y, element = [1])
end
for m0 ∈ range(synthesis.SL.t[1], synthesis.SL.t[end], 5)
    if m0 != synthesis.SL.t[end] &amp;&amp; m0 != synthesis.SL.t[1]
        t0 = synthesis.SL(m0)
        sol = solution(synthesis, t0, tlim[2], m0)
        add_solution_to_synthesis!(plt, sol, axis_arrow = :x)
    end
end
plt</code></pre><img src="basic-usage-2061555f.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Introduction</a><a class="docs-footer-nextpage" href="examples.html">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 8 April 2025 16:41">Tuesday 8 April 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
